# 料号检测系统

这是一个用于检测BOM表中失效料号、统计绑定料号需求并标记重要物料的桌面工具。界面基于 Tkinter，数据处理依赖 Excel 与 JSON/TXT 配置文件。

## 功能概览

- 读取配置文件中指定的失效料号数据库、绑定料号库以及重要物料关键字库。
- 在指定的 BOM Excel 中查找失效料号，整行标记为黑色，并在末尾插入替换料号及描述。
- 自动识别数量列，汇总料号数量，并依据绑定料号库计算需求、缺失与统计数据。
- 根据关键字（自动简繁转换）统计重要物料数量。
- 在原始 Excel 中新增“执行统计”“剩余物料”两个工作表输出汇总结果。
- 提供绑定料号库编辑器，支持直接编辑 JSON、导入/导出 Excel。

## 环境准备

```bash
pip install -r requirements.txt
```

> **提示**：`opencc-python-reimplemented` 依赖本地 OpenCC 词库，首次安装会自动下载。若在离线环境，可提前准备好相关文件。

## 使用方式

1. 按照 `config.json` 中的路径准备以下文件：
   - `失效料号.xlsx`：第 1/2 列为失效料号及描述，第 3/4 列为替换料号及描述。
   - `绑定料号.js`：JSON 格式的绑定料号库。
   - `重要物料.txt`：每行一个关键字。
2. 执行应用：
   ```bash
   python app.py
   ```
3. 在界面中选择需要处理的 BOM Excel，点击“执行”。
4. 如需维护绑定料号库，点击“编辑绑定料号”进行增删改或导入导出。

## 配置

`config.json` 用于定义数据库文件路径，默认为仓库根目录同名文件，如需自定义可修改该文件。

```json
{
  "invalid_part_db": "失效料号.xlsx",
  "binding_library": "绑定料号.js",
  "important_materials": "重要物料.txt"
}
```

确保这些路径在应用启动时可访问。

## 注意事项

- 数量列识别：程序默认跳过前三列，在其后的列中寻找数字列，并选择小数数量最少的列作为数量列。
- 替换料号：替换后数量统计会自动迁移至替换料号，绑定需求统计亦会采用替换后的料号。
- 重要物料匹配会自动进行简体化处理，以提高简繁混用时的匹配准确度。
